# Платежи ЮKassa

## Процесс

1. После подтверждения согласия создаётся платеж через `YooKassaClient.create_payment()`.
2. Пользователь получает `confirmation_url` и оплачивает.
3. ЮKassa отправляет webhook на `/payments/yookassa/webhook`.
4. Обработчик фиксирует статус в таблице `payments` и при успехе генерирует договор.

## Настройки

- `YOOKASSA_SHOP_ID` и `YOOKASSA_SECRET` — обязательны для боевого режима.
- `PUBLIC_BASE_URL` — используется в redirect URL.
- `WEB_HOST`/`WEB_PORT` — параметры локального web-сервера.

## Статусы

- `pending` — ожидание оплаты.
- `succeeded` — оплата подтверждена (договор генерируется).
- `canceled` — оплата отменена, уведомление логируется.

## Тестовый режим

- При отсутствии ключей SDK работает в stub-режиме и возвращает заглушечную ссылку.
- Для интеграционных тестов используйте тестовый кабинет ЮKassa.
